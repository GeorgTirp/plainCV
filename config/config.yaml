seed: 0

dataset: "fashion_mnist"
batch_size: 64
image_size: 28
num_epochs: 10
num_channels: 1
num_classes: 10

model: "resnet_small"  # or "mlp"

optim: pns_eigenadam  # or "muon", "adam", "soap", "pns_eigenadam", "hessian_free"
lr: 0.001
weight_decay: 0.01
beta1: 0.9
beta2: 0.999

# Optional Muon-specific fields (all have defaults):
muon_beta: 0.95
muon_ns_steps: 5
muon_ns_coeffs: [3.4445, -4.7750, 2.0315]
muon_nesterov: true
muon_adaptive: false


hf_cg_max_iters: 15   # instead of 50
hf_cg_tol: 1e-2      # looser tolerance
hf_damping: 1e-2

# --- PN-S EigenAdam–specific hyperparameters ---
pns_curvature_update_every: 2   # recompute eigenbasis every N steps
pns_max_eigenvectors: 15          # number of eigen-directions to track
pns_lanczos_iters: 15            # Lanczos iterations (None = use max_eigenvectors)
pns_precond_damping: 1.0e-4      # δ in (Λ + δI)^{-1}
pns_curvature_backend: ggn     # or "kronecker" if you implement that

schedule_free: False
schedule_free_lr: 0.01
schedule_free_b1: 0.9
schedule_free_weight_lr_power: 2.0

